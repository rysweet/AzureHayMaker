{
  "bundle_id": "e08c16b3-403b-4521-b159-c742931a799d",
  "name": "testing-scenario:-azure-bot-agent",
  "version": "1.0.0",
  "metadata": {
    "domain": "testing",
    "complexity": "simple",
    "phase_count": 4,
    "skill_count": 2,
    "estimated_duration": "22 minutes",
    "required_capabilities": [
      "test-execution",
      "test-coding",
      "analysis",
      "reporting",
      "automation",
      "framework-setup",
      "planning",
      "test-design"
    ],
    "skill_names": [
      "documenter",
      "tester"
    ],
    "parallel_opportunities": 0,
    "risk_factors": [
      "Standard execution risks apply"
    ]
  },
  "auto_mode_config": {
    "max_turns": 6,
    "initial_prompt": "# Goal: Scenario: Azure Bot Service with Q&A\n\n## Objective\n# Scenario: Azure Bot Service with Q&A\n\n## Technology Area\nAI & ML\n\n## Company Profile\n- **Company Size**: Small to mid-size company\n- **Industry**: Customer Support / SaaS\n- **Use Case**: Create intelligent chatbot that answers frequently asked questions and provides customer support escalation\n\n## Scenario Description\nDeploy Azure Bot Service with QnA Maker knowledge base integration to create an intelligent question-answering chatbot. Configure multiple channels, set up logging, and manage conversations through Azure services.\n\n## Azure Services Used\n- Azure Bot Service\n- Azure QnA Maker (Cognitive Services Language Understanding)\n- Azure App Service (for bot hosting)\n- Azure Storage Account (for conversation logs)\n- Azure Key Vault (for credentials)\n- Azure Application Insights (for bot analytics)\n\n## Prerequisites\n- Azure subscription with Contributor role\n- Azure CLI installed and configured\n- Bot Framework SDK (optional for local testing)\n- cURL or similar tool for API calls\n\n---\n\n## Phase 1: Deployment and Validation\n\n### Environment Setup\n```bash\n# Set variables\nUNIQUE_ID=$(date +%Y%m%d%H%M%S)\nRESOURCE_GROUP=\"azurehaymaker-bot-${UNIQUE_ID}-rg\"\nLOCATION=\"eastus\"\nBOT_SERVICE=\"azurehaymaker-bot-${UNIQUE_ID}\"\nBOT_APP_NAME=\"azurehaymaker-botapp-${UNIQUE_ID}\"\nQNA_RESOURCE=\"azurehaymaker-qna-${UNIQUE_ID}\"\nAPP_SERVICE_PLAN=\"azurehaymaker-asp-${UNIQUE_ID}\"\nSTORAGE_ACCOUNT=\"azhmabot${UNIQUE_ID}\"\nKEYVAULT=\"azurehaymaker-kv-${UNIQUE_ID}\"\nINSIGHTS_NAME=\"azurehaymaker-insights-${UNIQUE_ID}\"\n\n# Tags\nTAGS=\"AzureHayMaker-managed=true Scenario=ai-ml-bot-service Owner=AzureHayMaker\"\n```\n\n### Deployment Steps\n```bash\n# Step 1: Create Resource Group\naz group create \\\n  --name \"${RESOURCE_GROUP}\" \\\n  --location \"${LOCATION}\" \\\n  --tags ${TAGS}\n\n# Step 2: Create Application Insights for bot monitoring\naz monitor app-insights component create \\\n  --app \"${INSIGHTS_NAME}\" \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --location \"${LOCATION}\" \\\n  --kind web \\\n  --tags ${TAGS}\n\n# Step 3: Get Application Insights key\nINSIGHTS_KEY=$(az monitor app-insights component show \\\n  --app \"${INSIGHTS_NAME}\" \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --query \"instrumentationKey\" -o tsv)\n\nINSIGHTS_ID=$(az monitor app-insights component show \\\n  --app \"${INSIGHTS_NAME}\" \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --query \"id\" -o tsv)\n\necho \"Application Insights Key: ${INSIGHTS_KEY}\"\n\n# Step 4: Create App Service Plan\naz appservice plan create \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${APP_SERVICE_PLAN}\" \\\n  --sku B1 \\\n  --is-linux \\\n  --tags ${TAGS}\n\n# Step 5: Create App Service for bot hosting\naz webapp create \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --plan \"${APP_SERVICE_PLAN}\" \\\n  --name \"${BOT_APP_NAME}\" \\\n  --runtime \"NODE:18-lts\" \\\n  --tags ${TAGS}\n\n# Step 6: Get App Service URL\nBOT_APP_URL=\"https://${BOT_APP_NAME}.azurewebsites.net\"\necho \"Bot App URL: ${BOT_APP_URL}\"\n\n# Step 7: Create QnA Maker resource (Language service)\naz cognitiveservices account create \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${QNA_RESOURCE}\" \\\n  --kind Language \\\n  --sku S0 \\\n  --location \"${LOCATION}\" \\\n  --tags ${TAGS}\n\n# Step 8: Get QnA Maker endpoint and key\nQNA_ENDPOINT=$(az cognitiveservices account show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${QNA_RESOURCE}\" \\\n  --query \"properties.endpoint\" -o tsv)\n\nQNA_KEY=$(az cognitiveservices account keys list \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${QNA_RESOURCE}\" \\\n  --query \"key1\" -o tsv)\n\necho \"QnA Endpoint: ${QNA_ENDPOINT}\"\necho \"QnA Key: ${QNA_KEY}\"\n\n# Step 9: Create Storage Account for conversation logs\naz storage account create \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${STORAGE_ACCOUNT}\" \\\n  --location \"${LOCATION}\" \\\n  --sku Standard_LRS \\\n  --kind StorageV2 \\\n  --tags ${TAGS}\n\n# Step 10: Create storage containers\nSTORAGE_KEY=$(az storage account keys list \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --query '[0].value' -o tsv)\n\naz storage container create \\\n  --name \"conversation-logs\" \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --public-access off\n\naz storage container create \\\n  --name \"bot-configs\" \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --public-access off\n\n# Step 11: Create Key Vault for credentials\naz keyvault create \\\n  --name \"${KEYVAULT}\" \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --location \"${LOCATION}\" \\\n  --tags ${TAGS}\n\n# Step 12: Store credentials in Key Vault\naz keyvault secret set \\\n  --vault-name \"${KEYVAULT}\" \\\n  --name \"qna-endpoint\" \\\n  --value \"${QNA_ENDPOINT}\"\n\naz keyvault secret set \\\n  --vault-name \"${KEYVAULT}\" \\\n  --name \"qna-key\" \\\n  --value \"${QNA_KEY}\"\n\naz keyvault secret set \\\n  --vault-name \"${KEYVAULT}\" \\\n  --name \"bot-app-url\" \\\n  --value \"${BOT_APP_URL}\"\n\naz keyvault secret set \\\n  --vault-name \"${KEYVAULT}\" \\\n  --name \"insights-key\" \\\n  --value \"${INSIGHTS_KEY}\"\n```\n\n### Validation\n```bash\n# Verify Resource Group\naz group show --name \"${RESOURCE_GROUP}\"\n\n# Verify App Service\naz webapp show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${BOT_APP_NAME}\"\n\n# Verify Application Insights\naz monitor app-insights component show \\\n  --app \"${INSIGHTS_NAME}\" \\\n  --resource-group \"${RESOURCE_GROUP}\"\n\n# Verify QnA Maker Resource\naz cognitiveservices account show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${QNA_RESOURCE}\"\n\n# Verify Storage Account\naz storage account show --name \"${STORAGE_ACCOUNT}\"\n\n# Verify Storage Containers\naz storage container list \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --output table\n\n# Verify Key Vault\naz keyvault show --name \"${KEYVAULT}\"\n\n# List all resources\naz resource list --resource-group \"${RESOURCE_GROUP}\" --output table\n\n# Test Bot App Service endpoint\ncurl -I \"https://${BOT_APP_NAME}.azurewebsites.net/api/messages\" || echo \"Bot endpoint ready\"\n```\n\n---\n\n## Phase 2: Mid-Day Operations and Management\n\n### Management Operations\n```bash\n# Operation 1: Create sample QnA knowledge base (stored locally)\ncat > /tmp/qna-knowledge-base.json << EOF\n{\n  \"qnaList\": [\n    {\n      \"id\": 1,\n      \"answer\": \"Azure Bot Service is a cloud-based service that enables you to build intelligent bots that can interact with users across multiple channels.\",\n      \"source\": \"FAQ\",\n      \"questions\": [\n        \"What is Azure Bot Service?\",\n        \"Tell me about Bot Service\"\n      ]\n    },\n    {\n      \"id\": 2,\n      \"answer\": \"You can deploy bots to multiple channels including Web Chat, Teams, Slack, Facebook Messenger, and more.\",\n      \"source\": \"FAQ\",\n      \"questions\": [\n        \"What channels does Bot Service support?\",\n        \"Where can I deploy my bot?\"\n      ]\n    },\n    {\n      \"id\": 3,\n      \"answer\": \"QnA Maker is a cognitive service that analyzes questions and answers to create a searchable knowledge base.\",\n      \"source\": \"FAQ\",\n      \"questions\": [\n        \"What is QnA Maker?\",\n        \"How does QnA Maker work?\"\n      ]\n    }\n  ]\n}\nEOF\n\naz storage blob upload \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --container-name \"bot-configs\" \\\n  --name \"qna-knowledge-base-${UNIQUE_ID}.json\" \\\n  --file /tmp/qna-knowledge-base.json\n\n# Operation 2: Get App Service runtime and configuration\naz webapp show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${BOT_APP_NAME}\" \\\n  --query \"{Name: name, State: state, Runtime: runtimeVersion, Url: defaultHostName}\"\n\n# Operation 3: List web app configurations\naz webapp config appsettings list \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${BOT_APP_NAME}\" \\\n  --output table\n\n# Operation 4: Create sample conversation log\ncat > /tmp/conversation-log.txt << EOF\nConversation Log - ${UNIQUE_ID}\nTimestamp: $(date -u '+%Y-%m-%dT%H:%M:%SZ')\nUser: What is Azure Bot Service?\nBot: Azure Bot Service is a cloud-based service that enables you to build intelligent bots that can interact with users across multiple channels.\nUser: What channels does it support?\nBot: You can deploy bots to multiple channels including Web Chat, Teams, Slack, Facebook Messenger, and more.\nSentiment: Positive\nConfidence: 0.92\nEOF\n\naz storage blob upload \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --container-name \"conversation-logs\" \\\n  --name \"conversation-${UNIQUE_ID}.log\" \\\n  --file /tmp/conversation-log.txt\n\n# Operation 5: List all stored conversation logs\naz storage blob list \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --container-name \"conversation-logs\" \\\n  --output table\n\n# Operation 6: Monitor Application Insights bot performance\naz monitor app-insights metrics show \\\n  --app \"${INSIGHTS_NAME}\" \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --metric \"requests/rate\"\n\n# Operation 7: Check bot service and QnA service metrics\naz monitor metrics list \\\n  --resource \"/subscriptions/$(az account show --query id -o tsv)/resourceGroups/${RESOURCE_GROUP}/providers/Microsoft.CognitiveServices/accounts/${QNA_RESOURCE}\" \\\n  --metric \"SuccessfulRequests\" \\\n  --start-time $(date -u -d '1 hour ago' '+%Y-%m-%dT%H:%M:%SZ') \\\n  --end-time $(date -u '+%Y-%m-%dT%H:%M:%SZ')\n\n# Operation 8: Get App Service connection status and health\naz webapp show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${BOT_APP_NAME}\" \\\n  --query \"{State: state, AvailabilityState: availabilityState, HostNames: defaultHostName}\"\n\n# Operation 9: List stored knowledge base configurations\naz storage blob list \\\n  --account-name \"${STORAGE_ACCOUNT}\" \\\n  --account-key \"${STORAGE_KEY}\" \\\n  --container-name \"bot-configs\" \\\n  --output table\n\n# Operation 10: Retrieve QnA resource details and status\naz cognitiveservices account show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${QNA_RESOURCE}\" \\\n  --query \"{Name: name, Kind: kind, Sku: sku.name, Endpoint: properties.endpoint, ProvisioningState: properties.provisioningState}\"\n\n# Operation 11: Check Key Vault secrets\naz keyvault secret list --vault-name \"${KEYVAULT}\" --output table\n\n# Operation 12: Get Storage Account metrics and usage\naz storage account show \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${STORAGE_ACCOUNT}\" \\\n  --query \"{Name: name, Kind: kind, SkuName: sku.name, AccessTier: accessTier}\"\n```\n\n---\n\n## Phase 3: Cleanup and Tear-Down\n\n### Cleanup Steps\n```bash\n# Step 1: Stop the App Service\naz webapp stop \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --name \"${BOT_APP_NAME}\"\n\n# Step 2: Delete the entire resource group (includes all resources)\naz group delete \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --yes \\\n  --no-wait\n\n# Step 3: Wait for deletion to complete\necho \"Waiting for resource group deletion...\"\nsleep 120\n\n# Step 4: Verify deletion\naz group exists --name \"${RESOURCE_GROUP}\"\n\n# Step 5: Confirm cleanup\necho \"Verifying cleanup...\"\naz resource list --resource-group \"${RESOURCE_GROUP}\" 2>&1 | grep \"could not be found\" && echo \"\u2713 Resource group successfully deleted\"\n```\n\n---\n\n## Resource Naming Convention\n- Resource Group: `azurehaymaker-bot-${UNIQUE_ID}-rg`\n- Bot Service App: `azurehaymaker-botapp-${UNIQUE_ID}`\n- QnA Maker: `azurehaymaker-qna-${UNIQUE_ID}`\n- App Service Plan: `azurehaymaker-asp-${UNIQUE_ID}`\n- Storage Account: `azhmabot${UNIQUE_ID}`\n- Key Vault: `azurehaymaker-kv-${UNIQUE_ID}`\n- App Insights: `azurehaymaker-insights-${UNIQUE_ID}`\n\nAll resources tagged with: `AzureHayMaker-managed=true`\n\n---\n\n## Documentation References\n- [Azure Bot Service Documentation](https://learn.microsoft.com/en-us/azure/bot-service/)\n- [Create a Bot with Azure Bot Service](https://learn.microsoft.com/en-us/azure/bot-service/bot-service-quickstart-create-bot)\n- [QnA Maker Overview](https://learn.microsoft.com/en-us/azure/cognitive-services/qnamaker/overview/overview)\n- [Custom Question Answering](https://learn.microsoft.com/en-us/azure/cognitive-services/language-service/question-answering/overview)\n- [Bot Service Channels](https://learn.microsoft.com/en-us/azure/bot-service/bot-service-channels-reference)\n- [Bot Analytics with Application Insights](https://learn.microsoft.com/en-us/azure/bot-service/bot-service-manage-analytics)\n\n---\n\n## Automation Tool\n**Recommended**: Azure CLI\n\n**Rationale**: Azure CLI efficiently manages bot service provisioning, app service deployment, and resource configuration. It handles all infrastructure components needed for a fully operational bot in a single scripting interface.\n\n---\n\n## Estimated Duration\n- **Deployment**: 15-20 minutes\n- **Operations Phase**: 8+ hours (with knowledge base uploads, conversation logging, and performance monitoring)\n- **Cleanup**: 5-10 minutes\n\n---\n\n## Notes\n- Bot Service automatically handles channel-specific formatting and protocols\n- QnA Maker provides intelligent question-answer matching with confidence scores\n- Application Insights tracks bot conversations, user queries, and performance metrics\n- Conversation logs are stored for audit and analytics purposes\n- All operations scoped to single tenant and subscription\n- App Service can be scaled to handle bot traffic variations\n- Credentials securely managed in Key Vault for bot runtime access\n- Multiple channels can be connected to single bot service instance\n\n\n## Execution Plan\n\n### Phase 1: Test Planning\nPlan test strategy\n**Estimated Duration**: 5 minutes\n**Required Capabilities**: test-design, planning\n\n### Phase 2: Test Implementation\nImplement test cases\n**Estimated Duration**: 5 minutes\n**Required Capabilities**: test-coding, framework-setup\n**Dependencies**: Test Planning\n\n### Phase 3: Test Execution\nRun test suite\n**Estimated Duration**: 5 minutes\n**Required Capabilities**: test-execution, automation\n**Dependencies**: Test Implementation\n\n### Phase 4: Results Analysis\nAnalyze test results\n**Estimated Duration**: 5 minutes\n**Required Capabilities**: analysis, reporting\n**Dependencies**: Test Execution\n\n## Success Criteria\n- Goal 'Scenario: Azure Bot Service with Q&A...' is achieved\n\n## Instructions\nExecute the plan above autonomously:\n1. Follow each phase in sequence\n2. Use available skills and tools\n3. Verify success criteria are met\n4. Report progress and completion",
    "working_dir": ".",
    "sdk": "claude",
    "ui_mode": false,
    "success_criteria": [
      "Goal 'Scenario: Azure Bot Service with Q&A...' is achieved"
    ],
    "constraints": []
  }
}
